<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.475">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>MLBA - S24 - Clustering</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../../lectures/08_UnsupervisedLearning/082_DimensionReduction/ML_DimRed.html" rel="next">
<link href="../../../lectures/08_UnsupervisedLearning/080_Introduction/ML_UnsupIntro.html" rel="prev">
<link href="../../../images/logo.dark.png" rel="icon" type="image/png">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<meta property="og:title" content="MLBA - S24 - Clustering">
<meta property="og:description" content="In-class R script 📄">
<meta property="og:site-name" content="MLBA - S24 ">
</head>

<body class="nav-sidebar docked">


<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Clustering</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="../../../index.html" class="sidebar-logo-link">
      <img src="../../../images/logo.light.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      <div class="sidebar-tools-main tools-wide">
    <a href="http://moodle2.unil.ch/course/view.php?id=8715" title="Moodle" class="sidebar-tool px-1"><i class="bi bi-person-rolodex"></i></a>
    <a href="https://github.com/do-unil/mlba" title="GitHub Repo" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle sidebar-tool" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">Course information</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../index.html" class="sidebar-item-text sidebar-link">Overview</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../schedule.html" class="sidebar-item-text sidebar-link">Schedule</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../faq.html" class="sidebar-item-text sidebar-link">FAQ</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Lectures</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../lectures/01_Introduction/ML_Intro.html" class="sidebar-item-text sidebar-link">Intro to ML</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../lectures/02_DataExploration/ML_DataExplo.html" class="sidebar-item-text sidebar-link">Data Exploration</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../lectures/03_Models/030_Introduction/ML_Models_Intro.html" class="sidebar-item-text sidebar-link">Intro to Models</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../lectures/03_Models/031_LinearLogisticRegression/ML_LinLogReg.html" class="sidebar-item-text sidebar-link">Linear &amp; Logistic Regression</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../lectures/03_Models/032_Trees/ML_Trees.html" class="sidebar-item-text sidebar-link">Decision Trees</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../lectures/03_Models/033_NeuralNetworks/ML_NN.html" class="sidebar-item-text sidebar-link">Neural Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../lectures/03_Models/034_SupportVectorMachine/ML_SVM.html" class="sidebar-item-text sidebar-link">Support Vector Machines</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../lectures/04_Metrics/ML_Metrics.html" class="sidebar-item-text sidebar-link">Metrics</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../lectures/05_DataSplitting/ML_DataSplitting.html" class="sidebar-item-text sidebar-link">Data Splitting</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../lectures/06_Ensembles/ML_Ensemble.html" class="sidebar-item-text sidebar-link">Ensemble Methods</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../lectures/07_InterpretableML/ML_Interp.html" class="sidebar-item-text sidebar-link">Interpretable ML</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../lectures/08_UnsupervisedLearning/080_Introduction/ML_UnsupIntro.html" class="sidebar-item-text sidebar-link">Intro to Unsuperised Learning</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../lectures/08_UnsupervisedLearning/081_Clustering/ML_Clustering.html" class="sidebar-item-text sidebar-link active">Clustering</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../lectures/08_UnsupervisedLearning/082_DimensionReduction/ML_DimRed.html" class="sidebar-item-text sidebar-link">Dimension Reduction</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">Labs</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../labs/00_lab/setup.html" class="sidebar-item-text sidebar-link">Setup</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../labs/03_Models/031_LinearLogisticRegression/Ex_ML_LinLogReg.html" class="sidebar-item-text sidebar-link">Linear &amp; Logistic Regression</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../labs/03_Models/032_Trees/Ex_ML_Tree.html" class="sidebar-item-text sidebar-link">Decision Trees</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../labs/03_Models/033_NeuralNetworks/EX_ML_NN.html" class="sidebar-item-text sidebar-link">Neural Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../labs/03_Models/034_SupportVectorMachine/Ex_ML_SVM.html" class="sidebar-item-text sidebar-link">Support Vector Machines</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../labs/04_Metrics/Ex_ML_Scoring.html" class="sidebar-item-text sidebar-link">Metrics</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../labs/05_DataSplitting/Ex_ML_Data_Splitting.html" class="sidebar-item-text sidebar-link">Data Splitting</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../labs/06_Ensembles/Ex_ML_Ensemble.html" class="sidebar-item-text sidebar-link">Ensemble Methods</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../labs/07_InterpretableML/Ex_ML_VarImp.html" class="sidebar-item-text sidebar-link">Interpretable ML</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../labs/08_UnsupervisedLearning/081_Clustering/Ex_ML_Clustering.html" class="sidebar-item-text sidebar-link">Clustering</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../labs/08_UnsupervisedLearning/082_DimensionReduction/Ex_ML_PCA.html" class="sidebar-item-text sidebar-link">PCA</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../labs/08_UnsupervisedLearning/083_AutoEncoders/Ex_ML_Autoencoder.html" class="sidebar-item-text sidebar-link">Autoencoders</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">Assessments</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../assessments/Exam.html" class="sidebar-item-text sidebar-link">Exam</a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">Project</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../assessments/Project_Directives.html" class="sidebar-item-text sidebar-link">Project Directives</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../assessments/Report_Guideline.html" class="sidebar-item-text sidebar-link">Report Guidelines</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../assessments/Presentation_Guidelines.html" class="sidebar-item-text sidebar-link">Presentation Guidelines</a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false">Resources</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../resources/beginners_r.html" class="sidebar-item-text sidebar-link">Beginners in R</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../resources/data_acquisition/data_sources.html" class="sidebar-item-text sidebar-link">Data Sources</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../resources/data_acquisition/web_scraping_api.html" class="sidebar-item-text sidebar-link">Web Scraping</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../resources/cheatsheets.html" class="sidebar-item-text sidebar-link">Coding Cheatsheets</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#concepts" id="toc-concepts" class="nav-link active" data-scroll-target="#concepts">Concepts</a>
  <ul class="collapse">
  <li><a href="#clusters" id="toc-clusters" class="nav-link" data-scroll-target="#clusters">Clusters</a></li>
  <li><a href="#hierarchical-clustering-and-partitioning" id="toc-hierarchical-clustering-and-partitioning" class="nav-link" data-scroll-target="#hierarchical-clustering-and-partitioning">Hierarchical clustering and partitioning</a></li>
  </ul></li>
  <li><a href="#hierarchical-clustering" id="toc-hierarchical-clustering" class="nav-link" data-scroll-target="#hierarchical-clustering">Hierarchical clustering</a>
  <ul class="collapse">
  <li><a href="#concept" id="toc-concept" class="nav-link" data-scroll-target="#concept">Concept</a></li>
  <li><a href="#agnes" id="toc-agnes" class="nav-link" data-scroll-target="#agnes">AGNES</a></li>
  <li><a href="#dissimilarity" id="toc-dissimilarity" class="nav-link" data-scroll-target="#dissimilarity">Dissimilarity</a></li>
  <li><a href="#for-numerical-features" id="toc-for-numerical-features" class="nav-link" data-scroll-target="#for-numerical-features">For numerical features</a></li>
  <li><a href="#numerical-features" id="toc-numerical-features" class="nav-link" data-scroll-target="#numerical-features">Numerical features</a></li>
  <li><a href="#categorical-and-mixed-features-types" id="toc-categorical-and-mixed-features-types" class="nav-link" data-scroll-target="#categorical-and-mixed-features-types">Categorical and mixed features types</a></li>
  <li><a href="#mixed-features-types" id="toc-mixed-features-types" class="nav-link" data-scroll-target="#mixed-features-types">Mixed features types</a></li>
  <li><a href="#linkage" id="toc-linkage" class="nav-link" data-scroll-target="#linkage">Linkage</a></li>
  <li><a href="#dendrogram" id="toc-dendrogram" class="nav-link" data-scroll-target="#dendrogram">Dendrogram</a></li>
  </ul></li>
  <li><a href="#partitioning-methods" id="toc-partitioning-methods" class="nav-link" data-scroll-target="#partitioning-methods">Partitioning methods</a>
  <ul class="collapse">
  <li><a href="#partitioning-methods-1" id="toc-partitioning-methods-1" class="nav-link" data-scroll-target="#partitioning-methods-1">Partitioning methods</a></li>
  <li><a href="#k-means" id="toc-k-means" class="nav-link" data-scroll-target="#k-means">K-means</a></li>
  <li><a href="#partitioning-around-the-medoid" id="toc-partitioning-around-the-medoid" class="nav-link" data-scroll-target="#partitioning-around-the-medoid">Partitioning Around the Medoid</a></li>
  </ul></li>
  <li><a href="#number-of-clusters" id="toc-number-of-clusters" class="nav-link" data-scroll-target="#number-of-clusters">Number of clusters</a>
  <ul class="collapse">
  <li><a href="#choice-or-selection" id="toc-choice-or-selection" class="nav-link" data-scroll-target="#choice-or-selection">Choice or selection?</a></li>
  <li><a href="#total-within-cluster-sum-of-squares" id="toc-total-within-cluster-sum-of-squares" class="nav-link" data-scroll-target="#total-within-cluster-sum-of-squares">Total within-cluster sum of squares</a></li>
  <li><a href="#silhouette" id="toc-silhouette" class="nav-link" data-scroll-target="#silhouette">Silhouette</a></li>
  <li><a href="#average-silhouette" id="toc-average-silhouette" class="nav-link" data-scroll-target="#average-silhouette">Average silhouette</a></li>
  <li><a href="#silhouette-plot" id="toc-silhouette-plot" class="nav-link" data-scroll-target="#silhouette-plot">Silhouette plot</a></li>
  <li><a href="#divisive-hierarchical-clustering" id="toc-divisive-hierarchical-clustering" class="nav-link" data-scroll-target="#divisive-hierarchical-clustering">Divisive hierarchical clustering</a></li>
  </ul></li>
  <li><a href="#interpretation" id="toc-interpretation" class="nav-link" data-scroll-target="#interpretation">Interpretation</a>
  <ul class="collapse">
  <li><a href="#interpretation-1" id="toc-interpretation-1" class="nav-link" data-scroll-target="#interpretation-1">Interpretation</a></li>
  <li><a href="#example" id="toc-example" class="nav-link" data-scroll-target="#example">Example</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/do-unil/mlba/blob/main/lectures/08_UnsupervisedLearning/081_Clustering/ML_Clustering.qmd" class="toc-action">View source</a></p><p><a href="https://github.com/do-unil/mlba/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">
<script type="application/javascript">
// Description: Change image src depending on body class (quarto-light or quarto-dark)
function updateImageSrc() {
  var bodyClass = window.document.body.classList;
  var images = window.document.getElementsByTagName('img');
  for (var i = 0; i < images.length; i++) {
    var image = images[i];
    var src = image.src;
    var newSrc = src;
    if (bodyClass.contains('quarto-light') && src.includes('.dark')) {
      newSrc = src.replace('.dark', '.light');
    } else if (bodyClass.contains('quarto-dark') && src.includes('.light')) {
      newSrc = src.replace('.light', '.dark');
    }
    if (newSrc !== src) {
      image.src = newSrc;
    }
  }
}

var observer = new MutationObserver(function(mutations) {
  mutations.forEach(function(mutation) {
    if (mutation.type === 'attributes' && mutation.attributeName === 'class') {
      updateImageSrc();
    }
  });
});

observer.observe(window.document.body, {
  attributes: true
});

updateImageSrc();
</script>

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Clustering</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p><a href="ML_Clustering.R">In-class R script 📄</a></p>
<section id="concepts" class="level1">
<h1>Concepts</h1>
<section id="clusters" class="level3">
<h3 class="anchored" data-anchor-id="clusters">Clusters</h3>
<p>A <strong>cluster</strong> is a group of instances that share some common characteristics measured by the features. They are <strong>similar</strong>. Unlike classification (supervised learning) where groups are already defined, clustering aims at finding groups that <strong>do not exist a priori</strong>.</p>
</section>
<section id="hierarchical-clustering-and-partitioning" class="level3">
<h3 class="anchored" data-anchor-id="hierarchical-clustering-and-partitioning">Hierarchical clustering and partitioning</h3>
<p>Two different approaches:</p>
<ul>
<li><p>Hierarchical clustering: methods based on a <strong>dissimilarity matrix</strong> (hierarchical clustering).</p></li>
<li><p>Partitioning: methods based on the value of the features (K-Means, PAM).</p></li>
</ul>
</section>
</section>
<section id="hierarchical-clustering" class="level1">
<h1>Hierarchical clustering</h1>
<section id="concept" class="level3">
<h3 class="anchored" data-anchor-id="concept">Concept</h3>
<p>Hierarchical clustering algorithms</p>
<ul>
<li><p>Take a <strong>dissimilarity matrix</strong> as input: the features are used to compute dissimilarities between instances. The feature values are not by the algorithm strickly speaking.</p></li>
<li><p>Can be of two types: <strong>agglomerative</strong> (e.g., AGNES) or <strong>divisive</strong> (not treated).</p></li>
</ul>
<p>In agglomerative algorithm, once two instances are clustered, they cannot be separated.</p>
</section>
<section id="agnes" class="level3">
<h3 class="anchored" data-anchor-id="agnes">AGNES</h3>
<p>Accronym for <strong>AGglomerative NESting</strong>: a sequential algorithm:</p>
<ol type="1">
<li><p>To start each instance is a cluster in itself.</p></li>
<li><p>Merge the two closest clusters.</p></li>
<li><p>Repeat 2 until only one cluster remains.</p></li>
</ol>
<p>To merge two clusters (2), we need a <strong>linkage method</strong>. To link two clusters, we need <strong>dissimilarities</strong>.</p>
</section>
<section id="dissimilarity" class="level3">
<h3 class="anchored" data-anchor-id="dissimilarity">Dissimilarity</h3>
<p>A <strong>dissimilarity</strong> between two instances with features <span class="math inline">\(x\)</span> and <span class="math inline">\(x'\)</span> is a function <span class="math inline">\(d(\cdot, \cdot)\)</span> such that</p>
<ul>
<li><p>Non-negativity: <span class="math inline">\(d(x,x')\geq 0\)</span>,</p></li>
<li><p>Nullity: <span class="math inline">\(d(x,x') = 0\)</span> iff <span class="math inline">\(x=x'\)</span>,</p></li>
<li><p>Symmetry: <span class="math inline">\(d(x,x') = d(x',x)\)</span>,</p></li>
</ul>
<p>If further it satisfies the triangle inequality, <span class="math display">\[d(x, x') + d(x', x'') \geq d(x, x''),\]</span> then it is called a <strong>distance</strong></p>
</section>
<section id="for-numerical-features" class="level3">
<h3 class="anchored" data-anchor-id="for-numerical-features">For numerical features</h3>
<p>A general distance: <strong>Minkowski</strong>, <span class="math inline">\(q \geq 1\)</span> <span class="math display">\[d(x,x') = \left(\sum_{j=1}^p |x_j - x'_j|^q\right)^{1/q}\]</span> Special cases:</p>
<ul>
<li><p><strong>Euclidean</strong> for <span class="math inline">\(q=2\)</span> (the most used), <span class="math display">\[d(x,x') = \sqrt{\sum_{j=1}^p (x_{j} - x'_{j})^2}\]</span></p></li>
<li><p><strong>Manhattan</strong> for <span class="math inline">\(q=1\)</span>, <span class="math display">\[d(x,x') = \sum_{j=1}^p \vert x_j - x'_j \vert\]</span></p></li>
<li><p><strong>Maximum distance</strong> <span class="math inline">\(q=\infty\)</span>, <span class="math display">\[d(x,x') = \max_{j=1,\ldots p} \vert x_j - x'_j\vert\]</span></p></li>
</ul>
</section>
<section id="numerical-features" class="level3">
<h3 class="anchored" data-anchor-id="numerical-features">Numerical features</h3>
<p>Example on the <code>iris</code> data. The Euclidean distance between instances 1 and 2 is <span class="math inline">\(0.54\)</span></p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> iris[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>,<span class="sc">-</span><span class="dv">5</span>]</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    Sepal.Length Sepal.Width Petal.Length Petal.Width </span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>          <span class="fl">5.1</span>         <span class="fl">3.5</span>          <span class="fl">1.4</span>         <span class="fl">0.2</span> </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>          <span class="fl">4.9</span>         <span class="fl">3.0</span>          <span class="fl">1.4</span>         <span class="fl">0.2</span> </span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="sc">&gt;</span> <span class="fu">dist</span>(iris[<span class="dv">1</span><span class="sc">:</span><span class="dv">2</span>, <span class="sc">-</span><span class="dv">5</span>], <span class="at">p=</span><span class="dv">2</span>)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    <span class="fl">0.5385165</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>In detail, <span class="math display">\[\sqrt{(5.1-4.9)^2+(3.5-3.0)^2+(1.4-1.4)^2+(0.2-0.2)^2}=0.54\]</span></p>
</section>
<section id="categorical-and-mixed-features-types" class="level3">
<h3 class="anchored" data-anchor-id="categorical-and-mixed-features-types">Categorical and mixed features types</h3>
<p>When categorical features are present in the data set, the <strong>Gower index</strong> can be used. It combines dissimilarities to build a global one: <span class="math display">\[d_{ij} = \frac{\sum_{k=1}^p w_k d_{ij,k}}{\sum_{k=1}^p w_k}\]</span> is the dissimilarity between instances <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> over the <span class="math inline">\(p\)</span> features. The weight <span class="math inline">\(w_k\)</span> are always 1, except if <span class="math inline">\(x_ik\)</span> or <span class="math inline">\(x_jk\)</span> is missing, in which case it is <span class="math inline">\(0\)</span>. The dissimilarity <span class="math inline">\(d_{ij,k}\)</span> depends on the type of the feature <span class="math inline">\(x_k\)</span>:</p>
<ul>
<li><p>Numerical: <span class="math display">\[d_{ij,k} = |x_{ik} - x_{jk}|/r_k,\]</span> where <span class="math inline">\(r_k\)</span> is the range of variable <span class="math inline">\(k\)</span>,</p></li>
<li><p>Categorical: <span class="math inline">\(d_{ij,k} = 1\)</span> if <span class="math inline">\(x_{ik}\neq x_{jk}\)</span>, <span class="math inline">\(d_{ij,k} = 0\)</span> if <span class="math inline">\(x_{ik}= x_{jk}\)</span>.</p></li>
</ul>
</section>
<section id="mixed-features-types" class="level3">
<h3 class="anchored" data-anchor-id="mixed-features-types">Mixed features types</h3>
<p>Example:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>    Sepal.Length Sepal.Width Petal.Length Petal.Width    Color    Species</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>          <span class="fl">5.1</span>         <span class="fl">3.5</span>          <span class="fl">1.4</span>         <span class="fl">0.2</span>    mauve     setosa</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>          <span class="fl">4.9</span>         <span class="fl">3.0</span>          <span class="fl">1.4</span>         <span class="fl">0.2</span>   violet     setosa</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>          <span class="fl">4.7</span>         <span class="fl">3.2</span>          <span class="fl">1.3</span>         <span class="fl">0.2</span>   violet  virginica</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>The ranges are respectively <span class="math inline">\(3.6,2.4,5.9,2.4\)</span> (from the full data set). <span class="math display">\[\begin{aligned}
d_{12} &amp;=&amp; \frac{1}{6}\left(\frac{|5.1-4.9|}{3.6} + \frac{|3.5-3.0|}{2.4} + \frac{|1.4-1.4|}{5.9} + \frac{|0.2-0.2|}{2.4} + 1 + 0\right) = 0.2106.\\
d_{13} &amp;=&amp; 0.3755\\
d_{23} &amp;=&amp; 0.1926\end{aligned}\]</span></p>
</section>
<section id="linkage" class="level3">
<h3 class="anchored" data-anchor-id="linkage">Linkage</h3>
<p>Once the matrix of dissimilarities between all the instances is computed, we use <strong>linkage</strong> to merge the two clusters:</p>
<ul>
<li><p><strong>Single linkage</strong>: For all pairs of clusters <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>, compute the smallest dissimilarity between each pair of cluster members, <span class="math display">\[d(A,B) = \min \{d(x,x'): x\in A,\; x' \in B\}\]</span> Link <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> with the smallest <span class="math inline">\(d(A,B)\)</span>.</p></li>
<li><p><strong>Complete linkage</strong>: For all pairs of clusters <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>, compute the largest dissimilarity between each pair of cluster members, <span class="math display">\[d(A,B) = \max \{d(x, x'): x\in A,\; x' \in B\}\]</span> Link <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> with the smallest <span class="math inline">\(d(A,B)\)</span>.</p></li>
<li><p><strong>Ward</strong>’s method: merges the two clusters <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> such that, after the merging, the total within variance is minimum<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>.</p></li>
</ul>
</section>
<section id="dendrogram" class="level3">
<h3 class="anchored" data-anchor-id="dendrogram">Dendrogram</h3>
<p>The <strong>dendrogram</strong> is a graphical representation of the hierarchical clustering. It shows which clusters are grouped at each step <span class="math inline">\(k\)</span>, together with the dissimilarity on the <span class="math inline">\(y\)</span>-axis ate which they have been clustered.</p>
<p>Italian cities: Bari, Firenze, Napoli, Roma, Torino.</p>
<div class="quarto-layout-panel">
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../Graphs/Italy1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
<div class="quarto-layout-cell" style="flex-basis: 50.0%;justify-content: center;">
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../Graphs/Italy2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</div>
<p>Source: <a href="https://home.deib.polimi.it/matteucc/Clustering/tutorial_html/hierarchical.html" class="uri">https://home.deib.polimi.it/matteucc/Clustering/tutorial_html/hierarchical.html</a></p>
<p>AGNES is <strong>agglomerating</strong> because it starts from individual points and run up to a unique cluster, merging clusters one after the other. It is called "hierarchical" because when an instance is attached to a group, it cannot be separated from it anymore.</p>
<p>There also exist <strong>divisive</strong> hierarchical clustering, <strong>DIANA</strong>, for DIvise ANAlysis. It starts from one unique cluster with all the instances, and splits clusters one after the other, going down to one instance per cluster. Divise clustering is considered complex because at each step there exist a lot of possibilities to split a cluster.</p>
</section>
</section>
<section id="partitioning-methods" class="level1">
<h1>Partitioning methods</h1>
<section id="partitioning-methods-1" class="level3">
<h3 class="anchored" data-anchor-id="partitioning-methods-1">Partitioning methods</h3>
<p>Unlike the hierarchical clustering, <strong>partitioning methods</strong> apply for a given number of clusters. From an initial assignment of instances to <span class="math inline">\(k\)</span> clusters, the method allocates the instances to clusters such that a given criterion is optimized. Two popular methods are</p>
<ul>
<li><p>The <strong>K-means</strong>.</p></li>
<li><p>The <strong>Partitioning Around the Medoid</strong> (PAM).</p></li>
</ul>
<p>For <span class="math inline">\(k\)</span> clusters:</p>
<ol type="1">
<li><p>The initial clustering is random: assign each instance to one cluster at random.</p></li>
<li><p>Compute the centers of the clusters.</p></li>
<li><p>Each instance is then re-assigned to the cluster with the closest center.</p></li>
<li><p>Step 2. and 3. are repeated until a convergence criterion is satisfied.</p></li>
</ol>
<p>The K-means is suitable for <strong>numerical features only</strong>. The Euclidean distance is often used. Below is an illustration on simulated data, with <span class="math inline">\(k=2\)</span>, and the data (<span class="math inline">\(p=2\)</span>)</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../Graphs/kmeans1.png" class="img-fluid figure-img" style="width:35.0%"></p>
</figure>
</div>
<p>First step, each instance is randomly assigned (circles and triangles). The centers are computed (dots).</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../Graphs/kmeans2.png" class="img-fluid figure-img" style="width:35.0%"></p>
</figure>
</div>
<p>Next step, instances are re-assigned to the closest center. Then, new centers are computed. The clustering is already finished.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../Graphs/kmeans3.png" class="img-fluid figure-img" style="width:35.0%"></p>
</figure>
</div>
</section>
<section id="k-means" class="level3">
<h3 class="anchored" data-anchor-id="k-means">K-means</h3>
<p>Illustration for <span class="math inline">\(k=3\)</span> clusters.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../Graphs/kmeans4.png" class="img-fluid figure-img" style="width:35.0%"></p>
</figure>
</div>
</section>
<section id="partitioning-around-the-medoid" class="level3">
<h3 class="anchored" data-anchor-id="partitioning-around-the-medoid">Partitioning Around the Medoid</h3>
<p><strong>PAM</strong> extends the K-mean to <strong>features of mixed types</strong> (numerical and categorical) by extending the definition of the center of the cluster to <strong>a medoid</strong>. The medoid of cluster is the most representative instance belonging to it. The medoid of a cluster <span class="math inline">\(A\)</span> is the instance with smallest sum of dissimilarities with the other instances in the cluster <span class="math inline">\(A\)</span>: <span class="math display">\[m_A = \arg \min_{x \in A} \sum_{y\in A; y\neq x} d_{xy}\]</span> Unlike for the K-means, where the center is computed by averaging the features values (and thus may not be an instance of the data base), the medoid is an instance of its cluster. Therefore, PAM can be used for numerical and categorical features.</p>
<p>With the Italian cities, consider the cluster {BA, NA, RM}. Then the medoı̈d is NA. Indeed, the sum of dissimilarities are</p>
<ul>
<li><p>BA: <span class="math inline">\(d_{BA,NA}+d_{BA,RM} = 255+412=667\)</span></p></li>
<li><p>NA: <span class="math inline">\(d_{NA,BA}+d_{NA,RM} = 255+219=474\)</span></p></li>
<li><p>RM: <span class="math inline">\(d_{RM,BA}+d_{RM,NA} = 212+219=631\)</span></p></li>
</ul>
<p>Thus NA is the most representative city of this cluster. Note that the medoı̈d of cluster {MI, TO} is either MI or TO (at random).</p>
</section>
</section>
<section id="number-of-clusters" class="level1">
<h1>Number of clusters</h1>
<section id="choice-or-selection" class="level3">
<h3 class="anchored" data-anchor-id="choice-or-selection">Choice or selection?</h3>
<p>The number of clusters is often an <strong>arbitrary choice</strong> guided by the domain and the business application. This approach should be preferred if possible. It is also possible to select of the number of clusters with an index. There are a lot of such index<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>. In this course, we see</p>
<ul>
<li><p>The <strong>total within-cluster sum of squares</strong> (TWSS),</p></li>
<li><p>The <strong>silhouette</strong>.</p></li>
</ul>
<p>In practice, the index is computed for a clustering with <span class="math inline">\(1\)</span>, <span class="math inline">\(2\)</span>, <span class="math inline">\(3\)</span>, etc., clusters and the best choice is made.</p>
</section>
<section id="total-within-cluster-sum-of-squares" class="level3">
<h3 class="anchored" data-anchor-id="total-within-cluster-sum-of-squares">Total within-cluster sum of squares</h3>
<p>The sum of squares within cluster <span class="math inline">\(C\)</span>, whose center (mean or medoid) is <span class="math inline">\(x_C\)</span>, is the <span class="math display">\[\quad W_C=\sum_{i \in C} \Vert x_i - x_C\Vert^2 = \sum_{i \in C}\sum_{j=1}^p (x_{ij} - x_{Cj})^2.\]</span> The TWSS is the sum of all <span class="math inline">\(W_k\)</span> over the <span class="math inline">\(K\)</span> clusters <span class="math inline">\(C_1,\ldots,C_K\)</span>, <span class="math display">\[\sum_{k=1}^K W_{C_k}\]</span> The Each time a cluster is created (<span class="math inline">\(K \rightarrow K+1\)</span>), TWSS diminishes. The number of clusters is selected at <strong>an elbow</strong> on the graph. Below is a plot of clustering on data with TWSS (dendrogram with complete linkage):</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../Graphs/Nb_agnes_hc_wss.png" class="img-fluid figure-img" style="width:50.0%"></p>
</figure>
</div>
<p><span class="math inline">\(k=3\)</span> is a good choice here.</p>
<p>The <strong>silhouette</strong> measures how "well" an instance is within its cluster. Consider an instance <span class="math inline">\(x\)</span> assigned to cluster <span class="math inline">\(C\)</span>. Let <span class="math inline">\(d(x,A)\)</span> be <strong>the dissimilarity from <span class="math inline">\(x\)</span> to any cluster <span class="math inline">\(A\)</span></strong>: the average dissimilarity between <span class="math inline">\(x\)</span> and all the instances in cluster <span class="math inline">\(A\)</span>: <span class="math display">\[d(x,A) = \frac{1}{|A|} \sum_{y\in A} d_{xy}.\]</span> In particular, <strong><span class="math inline">\(d(x, C)\)</span> is the dissimilarity from <span class="math inline">\(x\)</span> to its cluster</strong>. A small <span class="math inline">\(d(x,C)\)</span> indicates a good clustering of <span class="math inline">\(x\)</span> within its cluster <span class="math inline">\(C\)</span>.</p>
<p>Now, consider <span class="math inline">\(d(x,\bar{C})\)</span>, the smallest average dissimilarities from <span class="math inline">\(x\)</span> to all the clusters to which it is not assigned (all but <span class="math inline">\(C\)</span>): <span class="math display">\[d(x,\bar{C}) = \min_{A\neq C} d(x, A)\]</span> This measures how <span class="math inline">\(x\)</span> is separated from the other clusters. A large <span class="math inline">\(d(x,\bar{C})\)</span> indicates a good separation of <span class="math inline">\(x\)</span> from all the other clusters (i.e., the ones in which <span class="math inline">\(x\)</span> is not).</p>
</section>
<section id="silhouette" class="level3">
<h3 class="anchored" data-anchor-id="silhouette">Silhouette</h3>
<p>The silhouette of <span class="math inline">\(x\)</span> combines</p>
<ul>
<li><p><span class="math inline">\(d(x, C)\)</span>, how well <span class="math inline">\(x\)</span> is integrated to its cluster <span class="math inline">\(C\)</span>, and</p></li>
<li><p><span class="math inline">\(d(x,\bar{C})\)</span>, how well <span class="math inline">\(x\)</span> is separated from the other clusters.</p></li>
</ul>
<p>The silhouette of <span class="math inline">\(x\)</span> is <span class="math display">\[s_x=\frac{d(x,\bar{C})-d(x,C)}{\max\left\{d(x,\bar{C}),d(x,C)\right\}}\]</span> The denominator ensures that <span class="math inline">\(-1\leq s_x\leq 1\)</span>. The larger <span class="math inline">\(s_x\)</span>, the better the clustering of <span class="math inline">\(x\)</span> in <span class="math inline">\(C\)</span>.</p>
</section>
<section id="average-silhouette" class="level3">
<h3 class="anchored" data-anchor-id="average-silhouette">Average silhouette</h3>
<p>The <strong>average silhouette</strong> of all instances is taken as a measure of the <strong>goodness of the clustering</strong>: <span class="math display">\[s = \frac{1}{n}\sum_{i=1}^n s_{x_i}.\]</span> The larger the average silhouette <span class="math inline">\(s\)</span>, the better the clustering overall. The number of clusters <span class="math inline">\(k\)</span> should maximize the average silhouette. The average silhouette should not be interpreted for itself. Now, we show a graph of clustering on data with average silhouette:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../Graphs/Nb_pam_sil.png" class="img-fluid figure-img" style="width:50.0%"></p>
</figure>
</div>
<p><span class="math inline">\(k=8\)</span> is a good choice here.</p>
<p>A detailed analysis of the clustering can be obtained using the <strong>silhouette plot</strong> shows: the silhouettes of all the instances.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../Graphs/Polstress-silhou.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
<p>Clusters 1 and 3 are well formed, Clusters 2 and 3 are less homogeneous.</p>
</section>
<section id="silhouette-plot" class="level3">
<h3 class="anchored" data-anchor-id="silhouette-plot">Silhouette plot</h3>
<p>Policemen - PAM <span class="math inline">\(k=4\)</span></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../Graphs/Polstress-silhou.png" class="img-fluid figure-img" style="width:80.0%"></p>
</figure>
</div>
</section>
<section id="divisive-hierarchical-clustering" class="level3">
<h3 class="anchored" data-anchor-id="divisive-hierarchical-clustering">Divisive hierarchical clustering</h3>
<p>AGNES is "agglomerating" because it starts from individual points and run up to a unique cluster, merging clusters one after the other. It is called "hierarchical" because when an instance is attached to a group, it cannot be separated from it anymore. "Divisive" hierarchical clustering also exists: <strong>DIANA</strong> for DIvise ANAlysis. It starts from one unique cluster with all the instances, and splits clusters one after the other, going down to one instance per cluster.</p>
</section>
</section>
<section id="interpretation" class="level1">
<h1>Interpretation</h1>
<section id="interpretation-1" class="level3">
<h3 class="anchored" data-anchor-id="interpretation-1">Interpretation</h3>
<p>What are the features behind: what feature/combination of features makes that an individual belong to a cluster. A usual method consists of representing each feature against the clusters.</p>
<p><strong>Example</strong>: 170 Swiss policemen recorded their emotional state in time using a questionnaire with ordinal scales (1 to 6). The features are</p>
<ul>
<li><p>mood,</p></li>
<li><p>stress,</p></li>
<li><p>emotion,</p></li>
<li><p>pressure,</p></li>
<li><p>social support,</p></li>
<li><p>situation familiarity,</p></li>
<li><p>material support.</p></li>
</ul>
<p>There is nothing to predict: the interest is to discover patterns in the data. Below is the scatter plots of the features (jittering points for more readability).</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../Graphs/Polstress-scat-jit.png" class="img-fluid figure-img" style="width:60.0%"></p>
</figure>
</div>
<p>4 clusters of policemen were formed using AGNES. They can be analyzed by the feature values within each cluster.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../Graphs/Polstress-groups-4.png" class="img-fluid figure-img" style="width:60.0%"></p>
</figure>
</div>
</section>
<section id="example" class="level3">
<h3 class="anchored" data-anchor-id="example">Example</h3>
<p>Some possible conclusions are</p>
<ul>
<li><p>Policemen in Cluster 3 have large mood, stress, and emotion values.</p></li>
<li><p>Pressure characterizes cluster 1 (low) versus clusters 2 to 4 (medium).</p></li>
<li><p>Mood and stress are associated because clusters 1 to 4 have the same levels of these two features.</p></li>
</ul>


</section>
</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>Other criteria are possible. Several algorithms exists (e.g., Ward 1963, Murtagh and Legendre 2014).<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>There are 30 index available in the function <code>NbClust</code> in <code>R</code>.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../../lectures/08_UnsupervisedLearning/080_Introduction/ML_UnsupIntro.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Intro to Unsuperised Learning</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../../lectures/08_UnsupervisedLearning/082_DimensionReduction/ML_DimRed.html" class="pagination-link">
        <span class="nav-page-text">Dimension Reduction</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">© Copyright 2024, <a href="https://iliaazizi.com/">Ilia Azizi &amp; Marc-Olivier Boldi</a></div>   
    <div class="nav-footer-right">This page is built with 🤍 and <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>



</body></html>