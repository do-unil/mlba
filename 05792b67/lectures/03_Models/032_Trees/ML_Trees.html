<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.475">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>MLBA - S24 - Decision Trees</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
</style>


<script src="../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../">
<link href="../../../lectures/03_Models/033_NeuralNetworks/ML_NN.html" rel="next">
<link href="../../../lectures/03_Models/031_LinearLogisticRegression/ML_LinLogReg.html" rel="prev">
<link href="../../../images/logo.dark.png" rel="icon" type="image/png">
<script src="../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script>

  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<meta property="og:title" content="MLBA - S24 - Decision Trees">
<meta property="og:description" content="In-class R script 📄">
<meta property="og:site-name" content="MLBA - S24 ">
</head>

<body class="nav-sidebar docked">


<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
    <div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">Decision Trees</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="../../../index.html" class="sidebar-logo-link">
      <img src="../../../images/logo.light.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      <div class="sidebar-tools-main tools-wide">
    <a href="http://moodle2.unil.ch/course/view.php?id=8715" title="Moodle" class="sidebar-tool px-1"><i class="bi bi-person-rolodex"></i></a>
    <a href="https://github.com/do-unil/mlba" title="GitHub Repo" class="sidebar-tool px-1"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-color-scheme-toggle sidebar-tool" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div>
      <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">Course information</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../index.html" class="sidebar-item-text sidebar-link">Overview</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../schedule.html" class="sidebar-item-text sidebar-link">Schedule</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../references.html" class="sidebar-item-text sidebar-link">References</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../faq.html" class="sidebar-item-text sidebar-link">FAQ</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Lectures</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../lectures/01_Introduction/ML_Intro.html" class="sidebar-item-text sidebar-link">Intro to ML</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../lectures/02_DataExploration/ML_DataExplo.html" class="sidebar-item-text sidebar-link">Data Exploration</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../lectures/03_Models/030_Introduction/ML_Models_Intro.html" class="sidebar-item-text sidebar-link">Intro to Models</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../lectures/03_Models/031_LinearLogisticRegression/ML_LinLogReg.html" class="sidebar-item-text sidebar-link">Linear &amp; Logistic Regression</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../lectures/03_Models/032_Trees/ML_Trees.html" class="sidebar-item-text sidebar-link active">Decision Trees</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../lectures/03_Models/033_NeuralNetworks/ML_NN.html" class="sidebar-item-text sidebar-link">Neural Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../lectures/03_Models/034_SupportVectorMachine/ML_SVM.html" class="sidebar-item-text sidebar-link">Support Vector Machines</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../lectures/04_Metrics/ML_Metrics.html" class="sidebar-item-text sidebar-link">Metrics</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../lectures/05_DataSplitting/ML_DataSplitting.html" class="sidebar-item-text sidebar-link">Data Splitting</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../lectures/06_Ensembles/ML_Ensemble.html" class="sidebar-item-text sidebar-link">Ensemble Methods</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../lectures/07_InterpretableML/ML_Interp.html" class="sidebar-item-text sidebar-link">Interpretable ML</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../lectures/08_UnsupervisedLearning/080_Introduction/ML_UnsupIntro.html" class="sidebar-item-text sidebar-link">Intro to Unsuperised Learning</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../lectures/08_UnsupervisedLearning/081_Clustering/ML_Clustering.html" class="sidebar-item-text sidebar-link">Clustering</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../lectures/08_UnsupervisedLearning/082_DimensionReduction/ML_DimRed.html" class="sidebar-item-text sidebar-link">Dimension Reduction</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">Labs</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../labs/00_lab/setup.html" class="sidebar-item-text sidebar-link">Setup</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../labs/03_Models/031_LinearLogisticRegression/Ex_ML_LinLogReg.html" class="sidebar-item-text sidebar-link">Linear &amp; Logistic Regression</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../labs/03_Models/032_Trees/Ex_ML_Tree.html" class="sidebar-item-text sidebar-link">Decision Trees</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../labs/03_Models/033_NeuralNetworks/EX_ML_NN.html" class="sidebar-item-text sidebar-link">Neural Networks</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../labs/03_Models/034_SupportVectorMachine/Ex_ML_SVM.html" class="sidebar-item-text sidebar-link">Support Vector Machines</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../labs/04_Metrics/Ex_ML_Scoring.html" class="sidebar-item-text sidebar-link">Metrics</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../labs/05_DataSplitting/Ex_ML_Data_Splitting.html" class="sidebar-item-text sidebar-link">Data Splitting</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../labs/06_Ensembles/Ex_ML_Ensemble.html" class="sidebar-item-text sidebar-link">Ensemble Methods</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../labs/07_InterpretableML/Ex_ML_VarImp.html" class="sidebar-item-text sidebar-link">Interpretable ML</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../labs/08_UnsupervisedLearning/081_Clustering/Ex_ML_Clustering.html" class="sidebar-item-text sidebar-link">Clustering</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../labs/08_UnsupervisedLearning/082_DimensionReduction/Ex_ML_PCA.html" class="sidebar-item-text sidebar-link">PCA</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../labs/08_UnsupervisedLearning/083_AutoEncoders/Ex_ML_Autoencoder.html" class="sidebar-item-text sidebar-link">Autoencoders</a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">Assessments</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../assessments/Exam.html" class="sidebar-item-text sidebar-link">Exam</a>
  </div>
</li>
          <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">Project</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth2 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../assessments/Project_Directives.html" class="sidebar-item-text sidebar-link">Project Directives</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../assessments/Report_Guideline.html" class="sidebar-item-text sidebar-link">Report Guidelines</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../assessments/Presentation_Guidelines.html" class="sidebar-item-text sidebar-link">Presentation Guidelines</a>
  </div>
</li>
      </ul>
  </li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false">Resources</a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" aria-expanded="false">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../resources/beginners_r.html" class="sidebar-item-text sidebar-link">Beginners in R</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../resources/data_acquisition/data_sources.html" class="sidebar-item-text sidebar-link">Data Sources</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../resources/data_acquisition/web_scraping_api.html" class="sidebar-item-text sidebar-link">Web Scraping</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../../../resources/cheatsheets.html" class="sidebar-item-text sidebar-link">Coding Cheatsheets</a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#concept" id="toc-concept" class="nav-link active" data-scroll-target="#concept">Concept</a>
  <ul class="collapse">
  <li><a href="#cart" id="toc-cart" class="nav-link" data-scroll-target="#cart">CART</a></li>
  <li><a href="#the-prediction-formula" id="toc-the-prediction-formula" class="nav-link" data-scroll-target="#the-prediction-formula">The prediction formula</a></li>
  <li><a href="#the-prediction-formula-regression" id="toc-the-prediction-formula-regression" class="nav-link" data-scroll-target="#the-prediction-formula-regression">The prediction formula: regression</a></li>
  <li><a href="#the-prediction-formula-classification" id="toc-the-prediction-formula-classification" class="nav-link" data-scroll-target="#the-prediction-formula-classification">The prediction formula: classification</a></li>
  <li><a href="#the-loss-function-regression" id="toc-the-loss-function-regression" class="nav-link" data-scroll-target="#the-loss-function-regression">The loss function: regression</a></li>
  <li><a href="#the-loss-function-classification" id="toc-the-loss-function-classification" class="nav-link" data-scroll-target="#the-loss-function-classification">The loss function: classification</a></li>
  <li><a href="#the-greedy-algorithm" id="toc-the-greedy-algorithm" class="nav-link" data-scroll-target="#the-greedy-algorithm">The greedy algorithm</a></li>
  </ul></li>
  <li><a href="#the-greedy-algorithm-1" id="toc-the-greedy-algorithm-1" class="nav-link" data-scroll-target="#the-greedy-algorithm-1">The greedy algorithm</a>
  <ul class="collapse">
  <li><a href="#splitting-the-data-space" id="toc-splitting-the-data-space" class="nav-link" data-scroll-target="#splitting-the-data-space">Splitting the data space</a></li>
  <li><a href="#cart-a-greedy-algorithm" id="toc-cart-a-greedy-algorithm" class="nav-link" data-scroll-target="#cart-a-greedy-algorithm">CART: a greedy algorithm</a></li>
  <li><a href="#a-greedy-algorithm" id="toc-a-greedy-algorithm" class="nav-link" data-scroll-target="#a-greedy-algorithm">A greedy algorithm</a></li>
  <li><a href="#stopping-rule" id="toc-stopping-rule" class="nav-link" data-scroll-target="#stopping-rule">Stopping rule</a></li>
  </ul></li>
  <li><a href="#interpretation" id="toc-interpretation" class="nav-link" data-scroll-target="#interpretation">Interpretation</a>
  <ul class="collapse">
  <li><a href="#interpretation-1" id="toc-interpretation-1" class="nav-link" data-scroll-target="#interpretation-1">Interpretation</a></li>
  </ul></li>
  <li><a href="#pruning" id="toc-pruning" class="nav-link" data-scroll-target="#pruning">Pruning</a>
  <ul class="collapse">
  <li><a href="#occams-razor" id="toc-occams-razor" class="nav-link" data-scroll-target="#occams-razor">Occam’s razor</a></li>
  <li><a href="#se-rule" id="toc-se-rule" class="nav-link" data-scroll-target="#se-rule">1-SE rule</a></li>
  <li><a href="#technical-details" id="toc-technical-details" class="nav-link" data-scroll-target="#technical-details">Technical details</a></li>
  </ul></li>
  </ul>
<div class="toc-actions"><div><i class="bi bi-github"></i></div><div class="action-links"><p><a href="https://github.com/do-unil/mlba/blob/main/lectures/03_Models/032_Trees/ML_Trees.qmd" class="toc-action">View source</a></p><p><a href="https://github.com/do-unil/mlba/issues/new" class="toc-action">Report an issue</a></p></div></div></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">
<script type="application/javascript">
// Description: Change image src depending on body class (quarto-light or quarto-dark)
function updateImageSrc() {
  var bodyClass = window.document.body.classList;
  var images = window.document.getElementsByTagName('img');
  for (var i = 0; i < images.length; i++) {
    var image = images[i];
    var src = image.src;
    var newSrc = src;
    if (bodyClass.contains('quarto-light') && src.includes('.dark')) {
      newSrc = src.replace('.dark', '.light');
    } else if (bodyClass.contains('quarto-dark') && src.includes('.light')) {
      newSrc = src.replace('.light', '.dark');
    }
    if (newSrc !== src) {
      image.src = newSrc;
    }
  }
}

var observer = new MutationObserver(function(mutations) {
  mutations.forEach(function(mutation) {
    if (mutation.type === 'attributes' && mutation.attributeName === 'class') {
      updateImageSrc();
    }
  });
});

observer.observe(window.document.body, {
  attributes: true
});

updateImageSrc();
</script>

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title d-none d-lg-block">Decision Trees</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header>

<p><a href="ML_Trees.R">In-class R script 📄</a></p>
<section id="concept" class="level1">
<h1>Concept</h1>
<section id="cart" class="level3">
<h3 class="anchored" data-anchor-id="cart">CART</h3>
<p>CART stands for <strong>C</strong>lassification <strong>A</strong>nd <strong>R</strong>egression <strong>T</strong>rees. It consists of</p>
<ul>
<li><p>A hierarchical set of binary rules,</p></li>
<li><p>A representation in a shape of a tree.</p></li>
</ul>
<p>It applies to both regression and classification tasks. The Iris data has 105 data; with the classes equally divided in 35 observations.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../Graphs/IRIS_CART.png" class="img-fluid figure-img" style="width:10cm"></p>
</figure>
</div>
<p>In this case the rule is that if Petal length <span class="math inline">\(&lt; 2.45\)</span> then Setosa, else if Petal width <span class="math inline">\(&lt; 1.65\)</span> then Versicolor, else Virginica.</p>
</section>
<section id="the-prediction-formula" class="level3">
<h3 class="anchored" data-anchor-id="the-prediction-formula">The prediction formula</h3>
<p>The set of rules including the order of the features and the thresholds at each node can be embedded into a set of parameters <span class="math inline">\(\theta\)</span>.<br>
After the training, the tree contains of final nodes. We use the notation below,</p>
<ul>
<li><p>Applying the rules to features <span class="math inline">\(x\)</span> send the instance <span class="math inline">\((y,x)\)</span> to the final node that we call <span class="math inline">\(N(x)\)</span>.</p></li>
<li><p>In the training set <span class="math inline">\((y_1,x_1), \ldots, (y_n,x_n)\)</span>, the set of instances that were sent to node <span class="math inline">\(N\)</span> is called <span class="math inline">\(I(N)\)</span>. E.g., <span class="math inline">\(I(N)=\{1,3,4\}\)</span> means that instances <span class="math inline">\((y_1,x_1),(y_3,x_3),(y_4,x_4)\)</span> were sent to node <span class="math inline">\(N\)</span>.</p></li>
<li><p>The prediction for features <span class="math inline">\(x\)</span> is noted <span class="math inline">\(f(x;\theta)\)</span>. That prediction only depends on the node to which <span class="math inline">\(x\)</span> is sent. In other words, <span class="math display">\[N(x) = N(x') \quad \Longrightarrow \quad f(x;\theta) = f(x';\theta).\]</span></p></li>
</ul>
</section>
<section id="the-prediction-formula-regression" class="level3">
<h3 class="anchored" data-anchor-id="the-prediction-formula-regression">The prediction formula: regression</h3>
<p>For regression, <span class="math inline">\(f(x;\theta)\)</span>, the prediction for <span class="math inline">\(x\)</span>, is the mean of the <span class="math inline">\(y_i\)</span>’s that were sent to the node of <span class="math inline">\(x\)</span> during the training.<br>
In more fancy terms, <span class="math display">\[f(x;\theta) = \frac{1}{|I(N(x))|}\sum_{i \in I(N(x))} y_i.\]</span></p>
</section>
<section id="the-prediction-formula-classification" class="level3">
<h3 class="anchored" data-anchor-id="the-prediction-formula-classification">The prediction formula: classification</h3>
<p>For classification,</p>
<ul>
<li><p>The node <span class="math inline">\(N(x)\)</span> has a predicted probability vector: probabilities one each possible class <span class="math display">\[p(x;\theta) = (p_1(x;\theta), \ldots, p_C(x;\theta)),\]</span></p></li>
<li><p>The prediction <span class="math inline">\(f(x;\theta)\)</span> is the class that has highest probability: <span class="math display">\[f(x;\theta) = \arg\max_{c=1,\ldots,C} p_c(x;\theta).\]</span></p></li>
</ul>
<p>The predicted probabilities <span class="math inline">\(p(x;\theta)\)</span> at node <span class="math inline">\(N(x)\)</span> are the proportions of each class taken on all the instances sent to <span class="math inline">\(N(x)\)</span> during the training.<br>
In more fancy terms, for any class <span class="math inline">\(c\)</span>, <span class="math display">\[p_c(x;\theta) = \frac{1}{|I(N(x))|}\sum_{i \in I(N(x))} 1_{\{y_i = c\}}.\]</span></p>
</section>
<section id="the-loss-function-regression" class="level3">
<h3 class="anchored" data-anchor-id="the-loss-function-regression">The loss function: regression</h3>
<p>For the regression case, the most used loss function is the MSE: <span class="math display">\[\bar{\cal L}(\theta) = \frac{1}{n} \sum_{i=1}^n \left\{y_i - f(x_i;\theta)\right\}^2\]</span></p>
<p>For the classification case, the most used loss is the <strong>entropy</strong>. It is different from the one of logistic regression<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a>. In the case of <span class="math inline">\(C\)</span> classes, the entropy is <span class="math display">\[\begin{aligned}
{\cal L}(y, p) &amp;=&amp; - p_1 \log p_1 - p_2 \log p_2 - \cdots - p_C \log p_C\\
&amp;=&amp; - \sum_{c=1}^C p_C \log p_c.\end{aligned}\]</span> A the global entropy is thus <span class="math display">\[\begin{aligned}
\bar{\cal L}(\theta) &amp;=&amp; - \sum_{i=1}^n\sum_{c=1}^C p_c(x_i;\theta) \log p_c(x_i;\theta).\end{aligned}\]</span></p>
</section>
<section id="the-loss-function-classification" class="level3">
<h3 class="anchored" data-anchor-id="the-loss-function-classification">The loss function: classification</h3>
<p>Other possible choices for the loss function are:<br>
The <strong>classification error</strong>: <span class="math display">\[{\cal L}(y,p) = 1 - p_y.\]</span> If <span class="math inline">\(y=c\)</span>, then <span class="math inline">\(p_c\)</span> should be large and <span class="math inline">\(1-p_c\)</span> should be small.<br>
The <strong>Gini index</strong>: <span class="math display">\[{\cal L}(y,p) = p_1(1-p_1) + \cdots + p_C(1-p_C) = \sum_{c=1}^C p_c(1-p_c).\]</span> This index is smaller if <span class="math inline">\(p\)</span> has one large component and the other ones small (e.g., <span class="math inline">\((1,0,0,0)\)</span>). It is thus minimum when the prediction is certain. For this, it is similar to the entropy.</p>
</section>
<section id="the-greedy-algorithm" class="level3">
<h3 class="anchored" data-anchor-id="the-greedy-algorithm">The greedy algorithm</h3>
<p>Finding the optimal <span class="math inline">\(\theta\)</span> cannot be obtained using a Newton-Raphson algorithm because <span class="math inline">\(f(x;\theta)\)</span> is not differentiable.<br>
To obtain the optimal <span class="math inline">\(\hat{\theta}\)</span>, one should search among all possible splitting combinations. The complexity of such task is enormous and cannot be achieved even with the most powerful imaginable computers.<br>
An approximate solution is obtained by the <strong>greedy algorithm</strong>.</p>
</section>
</section>
<section id="the-greedy-algorithm-1" class="level1">
<h1>The greedy algorithm</h1>
<section id="splitting-the-data-space" class="level3">
<h3 class="anchored" data-anchor-id="splitting-the-data-space">Splitting the data space</h3>
<p>The tree splits the space into rectangles<a href="#fn2" class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>. Below with two features:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../Graphs/CART_Picture.png" class="img-fluid figure-img" style="width:10cm"></p>
</figure>
</div>
<p>Each rectangle is associated to one node and one prediction.</p>
<p>The greedy algorithm grows the tree step by step as follows:</p>
<ul>
<li><p>Start with no partition,</p></li>
<li><p>Along each feature <span class="math inline">\(x_j\)</span>, find the best split of the training set by this feature. This gives <span class="math inline">\(p\)</span> splits (one for each feature).</p></li>
<li><p>Compare the <span class="math inline">\(p\)</span> splits and select the best one: the one diminishing the loss the most.</p></li>
</ul>
<p>You obtain two nodes, <span class="math inline">\(N_1\)</span> and <span class="math inline">\(N_2\)</span>, say. Repeat the above rule on each node until a stopping rule is reached (see later).</p>
<p>Example of classification:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../Graphs/Cart_Build.png" class="img-fluid figure-img" style="width:12cm"></p>
</figure>
</div>
<p>Note: by convention <span class="math inline">\(0\times \ln 0 = 0\)</span>.</p>
</section>
<section id="cart-a-greedy-algorithm" class="level3">
<h3 class="anchored" data-anchor-id="cart-a-greedy-algorithm">CART: a greedy algorithm</h3>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../Graphs/Cart_Build2.png" class="img-fluid figure-img" style="width:12cm"></p>
</figure>
</div>
<p>etc.</p>
</section>
<section id="a-greedy-algorithm" class="level3">
<h3 class="anchored" data-anchor-id="a-greedy-algorithm">A greedy algorithm</h3>
<p>Example of regression:</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="../../Graphs/RT_Build.png" class="img-fluid figure-img" style="width:12cm"></p>
</figure>
</div>
</section>
<section id="stopping-rule" class="level3">
<h3 class="anchored" data-anchor-id="stopping-rule">Stopping rule</h3>
<p>The algorithm could go on splitting the feature space forever. Several stopping rules can be used. For example in <code>R</code> with <code>rpart</code> (see <code>?rpart.control</code>):</p>
<ul>
<li><p><code>minsplit</code>: the minimum number of observations that must exist in a node in order for a split to be attempted (default is 20).</p></li>
<li><p><code>cp</code>: Any split that does not decrease the overall lack of fit by a factor of cp is not attempted (default to 0.1).</p></li>
<li><p><code>minbucket</code>: the minimum number of observations in any terminal node (default to <code>minsplit/3</code>).</p></li>
<li><p>etc.</p></li>
</ul>
<p>Even with these rules, once the tree is grown, it might be too large. The procedure of cutting nodes is called <code>pruning</code> the tree.</p>
</section>
</section>
<section id="interpretation" class="level1">
<h1>Interpretation</h1>
<section id="interpretation-1" class="level3">
<h3 class="anchored" data-anchor-id="interpretation-1">Interpretation</h3>
<p>Trees can be interpreted by reading directly on the graph the link between the features and the outcome.</p>
<ul>
<li><p>The most important feature is at the top of the graph. The first split influence the other ones.</p></li>
<li><p>The final nodes should be organized in a logical way to ease the reading. E.g.,</p>
<ul>
<li><p>(regression) Low predictions to the left, high predictions to the right.</p></li>
<li><p>(binary) predictions "0" to the left, and "1" to the right.</p></li>
</ul></li>
</ul>
<p>Interpretation must be done with cautious. The tree structure is unstable: several trees can produce similar predictions. The greedy algorithm may just pick one at random.</p>
</section>
</section>
<section id="pruning" class="level1">
<h1>Pruning</h1>
<section id="occams-razor" class="level3">
<h3 class="anchored" data-anchor-id="occams-razor">Occam’s razor</h3>
<p>For linear and logistic regressions, the more variables are in the model, the more complex that model is. For trees, model complexities can be measured by the length of the tree: <em>a shorter tree is more simple than a longer one</em>. To apply Occan’s razor, one needs to shorten the tree without impeding too much its prediction quality. To <strong>prune</strong> the tree consists of cutting branches while maintaining enough prediction quality.</p>
</section>
<section id="se-rule" class="level3">
<h3 class="anchored" data-anchor-id="se-rule">1-SE rule</h3>
<p>There exist several ways to prune the tree. One of the most used is the <strong>1-SE</strong> rule.</p>
<ul>
<li><p>Build a long tree (using the default stopping rules)</p></li>
<li><p>For all the sub-trees compute the error of the tree</p></li>
<li><p>For the best tree (lowest error) compute the uncertainty on that error measure: the <strong>standard error</strong> SE.</p></li>
<li><p>Any tree whose error is below the lowest error plus one SE is considered equivalent to the best tree.</p></li>
<li><p>Select the shortest tree among those that are equivalent to the best one.</p></li>
</ul>
</section>
<section id="technical-details" class="level3">
<h3 class="anchored" data-anchor-id="technical-details">Technical details</h3>
<ul>
<li><p>The SE is computed using cross-validation (see later).</p></li>
<li><p>The 1-SE rule can be replaced by other rules (like cutting at a given CP, etc.).</p></li>
</ul>
<p>In practice,</p>
<ul>
<li><p>the pruning is not a guarantee to obtain a good model.</p></li>
<li><p>It should be used to simplify the model and avoid overfitting.</p></li>
<li><p>(empirical) it works well to build a very large tree then to prune it.</p></li>
</ul>


</section>
</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>For logistic regression, it is the cross-entropy.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2"><p>Several trees may be equivalent.<a href="#fnref2" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  let localAlternateSentinel = 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../../../lectures/03_Models/031_LinearLogisticRegression/ML_LinLogReg.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">Linear &amp; Logistic Regression</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../../../lectures/03_Models/033_NeuralNetworks/ML_NN.html" class="pagination-link">
        <span class="nav-page-text">Neural Networks</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">© Copyright 2024, <a href="https://iliaazizi.com/">Ilia Azizi &amp; Marc-Olivier Boldi</a></div>   
    <div class="nav-footer-right">This page is built with 🤍 and <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>



</body></html>